%===============================================================================
\section{Modelos para sistemas não lineares}
\label{sec:nl_models}
%===============================================================================

\cite{CampiSacvaresi-vrft_nonlinear}

%===============================================================================
\subsection{Modelos de Wiener e Hammerstein}
\label{sec:nl_models_wiener_hammerstein}
% Aguirre: 334
% ljung 143
%===============================================================================

Em uma situação onde a dinâmica do sistema pode ser bem descrita por um sistema linear, 
mas existem algumas não linearidades estáticas atreladas a entrada e/ou a saída.
Este será o caso de atuadores serem não lineares como por exemplo: devido a saturação, 
ou se o sensor tem características não lineares. 

Um modelo com não linearidades na entrada é chamado de {\it{modelo de Hammerstein}} e 
para não linearidades na saída chama-se {\it{modelo de Wiener}}. \cite{ljung}

Considere o sistema apresentado em \eqref{eq:nl_linearization_sys} e o caso de 
Hammerstein, tem-se que a função estática não linear $f(\cdot)$ pode ser parametrizado
tanto em termos de parâmetros físicos, como ponto ou nível de saturação, como pode
ser parametrizado por modelo caixa preta.

Na Figura (\ref{fig:nl_models_hammerstein_wiener}) observa-se o diagrama de bloco para os modelos
de Hammerstein e Wiener.


\begin{figure}[htbp]
\center
\scalebox{1} % Change this value to rescale the drawing.
{
	\begin{pspicture}(0,-1.4)(8.949375,1.4)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,0.8)(1.2,0.8)
		\psframe[linewidth=0.04,dimen=outer](3.4,1.4)(1.2,0.2)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.4,0.8)(4.6,0.8)
		\psframe[linewidth=0.04,dimen=outer](6.8,1.4)(4.6,0.2)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.8,0.8)(8.0,0.8)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,-0.8)(1.2,-0.8)
		\psframe[linewidth=0.04,dimen=outer](3.4,-0.2)(1.2,-1.4)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.4,-0.8)(4.6,-0.8)
		\psframe[linewidth=0.04,dimen=outer](6.8,-0.2)(4.6,-1.4)
		\psline[linewidth=0.04cm,arrowsize=0.08cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.8,-0.8)(8.0,-0.8)
		\usefont{T1}{ptm}{m}{n}
	\rput(0.489375,1.11){u(t)}
	\usefont{T1}{ptm}{m}{n}
	\rput(3.900625,1.11){f(u(t))}
	\usefont{T1}{ptm}{m}{n}
	\rput(7.299375,1.11){y(t)}
	\usefont{T1}{ptm}{m}{n}
	\rput(5.6226563,0.91){Modelo}
	\usefont{T1}{ptm}{m}{n}
	\rput(5.5264063,0.51){Linear}
	\usefont{T1}{ptm}{m}{n}
	\rput(2.2226562,-0.69){Modelo}
	\usefont{T1}{ptm}{m}{n}
	\rput(2.1264062,-1.09){Linear}
	\usefont{T1}{ptm}{m}{n}
	\rput(2.180625,0.71){f()}
	\usefont{T1}{ptm}{m}{n}
	\rput(5.580625,-0.89){f()}
	\usefont{T1}{ptm}{m}{n}
	\rput(7.949375,-0.49){y(t)=f(z(t))}
	\usefont{T1}{ptm}{m}{n}
	\rput(0.489375,-0.49){u(t)}
	\usefont{T1}{ptm}{m}{n}
	\rput(3.876875,-0.49){z(t)}
	\end{pspicture} 
}
\caption{Acima: modelo de Hammerstein. Abaixo: Modelo de Wiener.}
\label{fig:nl_models_hammerstein_wiener}
\end{figure}

%===============================================================================
\subsection{Serie de Volterra}
\label{sec:nl_models_volterra}
% Aguirre 334
%===============================================================================

Um sistema não linear pode ser descrito pela serie de Voltera \eqref{eq:nl_models_voltera}:

\begin{equation}
y(t)=\sum_{j=1}^{\infty}\int_{-\infty}^{\infty}\cdots \int_{-\infty}^{\infty}
h_j(\tau_1, ... ,\tau_j) \prod_{i=1}^{j}u(t-\tau_i)d\tau_i
\label{eq:nl_models_voltera}
\end{equation}

Onde $h_j$ são generalizações não lineares da resposta ao impulso $h_1(t)$ . Para
um sistema linear com $j=1$ a equação de Voltera se reduz a integral de convolução.
\cite{aguirre}

Grande dificuldade de utilizar a serie de Voltera \eqref{eq:nl_models_voltera} é que
até para sistemas pouco não lineares, o numero de parâmetros a estimar é grande. Isso
se dá pelo fato da série tentar explicar a saída do sistema apenas baseado nos valores
da entrada deste.

%===============================================================================
\subsection{Funções Radiais de Base}
\label{sec:nl_models_radiais}
% Aguirre 337
%===============================================================================

Funções radiais de base ({\it{RBF - Radial basis functions}} são mapeamentos do tipo:

\begin{equation}
f(y)-w_0+\sum_{i}w_i \phi (\left \| y-c_i \right \|)
\label{eq:nl_models_rbf}
\end{equation}

Sendo que $y \in \mathbb{R}^{d_e}$ ($d_e$ é conhecido como dimensão de imersão),
$\left \| \cdot \right \|$ é a norma euclidiana, $w_i \in \mathbb(R)$ são pesos, 
$c_i \in \mathbb{R}^{d_e}$ são centros e $\phi(\cdot):\mathbb{R}^+ \to \mathbb{R}$ 
é uma função, normalmente escolhida a priori, como por exemplo: \cite{aguirre}

\begin{equation}
\phi(\left \| y-c_i \right \|)= exp\left ( -\frac{\left \| y-c_i \right \|^2}{\sigma_i^2} \right )
\nonumber
\end{equation}

Outras funções de base usadas são apresentadas na Tabela \ref{table:nl_models_rbf}

\begin{table*}[htbp]
\begin{center}
\caption{Algumas funções Radiais de base comumente usadas.}
\label{table:nl_models_rbf}
\begin{tabular}{ll}
\hline
        Nome & Função   \\
\hline
        Multi quadrática inversa  & $\phi(r)=(r^2+\sigma ^2)^{-1/2}$ \\ 
        Linear                    & $\phi(r)=r$                      \\ 
        Cúbica                    & $\phi(r)=r^3$                    \\ 
        Multiquadrática           & $\phi(r)=\sqrt{r^2+\sigma^2}$    \\ 
        {\it{Thin - plate spline}} & $\phi(r)=r^2\; \text{log}(r)$   \\ 
\hline
\end{tabular}
\end{center}
\end{table*}

Sendo que $r=\left \| y-c_i \right \|$ e $\sigma$ definem a largura do chapéu no caso de
funções gausianas e das multiquadráticas, como pode ser visto na figura (\ref{fig:nl_models_rbf}).

\begin{figure}[htbp]
	\center
	\includegraphics[width=0.8\columnwidth]{figures/nl_models_rbf.eps}
	\caption{Função multiquadráticas inversa para alguns valores de $\sigma$.}
	\label{fig:nl_models_rbf}
\end{figure}

Este tipo de representação tem boas propriedades locais e pode ser interpretada como 
uma técnica de interpolação global. Funções radiais de base são casos particulares
de redes neurais, porem neste caso lineares nos parametros $w_i$.\cite{aguirre} 

No contexto de identificação de sistemas é comum adicionar termos auto-regressivos
lineares, bem como termos de entrada à equação \eqref{eq:nl_models_rbf} resultando em:

\begin{equation}
y(k)=w_0 + \sum_{i}w_i \phi(\left \| \mathbf{y}(k-1)-c_i \right \|)+\sum_{i=1}^{n_y}a_i y(k-i)+\sum_{i=1}^{n_u}b_i u(k-i)+e(k)
\nonumber
\end{equation}

Sendo $\mathbf{y}(k-1)=\begin{bmatrix}
y(k-1) & ... & y(k-n_y) & u(k-1) & ... & u(k-n_u)
\end{bmatrix}$.

%===============================================================================
\subsection{Modelo polinomial NARMAX}
\label{sec:nl_models_pol_narmax}
% Aguirre 343
%===============================================================================



%===============================================================================
\subsection{Modelo Racional NARMAX}
\label{sec:nl_models_rational_narmax}
% Aguirre 343
%===============================================================================
