%===============================================================================
\section{Modelos NARMAX}
\label{sec:nl_models_narmax}
% Aguirre 343
%===============================================================================

Os modelos {\it{NARX}} (do termo inglês {\it{nonlinear autoregressive model with
exogenous variables}}) são modelos discretos no tempo que caracterizam o valor da saída em função
dos valores passados da entrada e da própria saída. Algumas vezes, para evitar a polarização da estimativa dos
parâmetros adiciona-se termos do modelo do ruído ao modelo do sistema. Quando isso é feito o modelo passa a ser chamado
de modelo {\it{NARMAX}} (do termo inglês {\it{nonlinear autoregressive moving average model with
exogenous variables}}), introduzido por \cite{leontaritis_billings1985}.

Este modelo provê uma representação unificada para a descrição de sistemas discretos não lineares:

\begin{equation}
y(t)=\theta^T\Phi_{nl}(y, u, e)+e(t)
\label{eq:nlin_models_narmax_generic}
\end{equation}
onde $\Phi_{nl}(\cdot)$ denota uma equação não linear que depende dos sinais passados de $y(t)$ e presente e passados
de $u(t)$ e $e(t)$. $\theta$ é o vetor de parâmetros a ser identificado.

As classes de modelos NARMAX podem então ser compreendidas como um conjunto ou somatório de funções não lineares, que
são parametrizados linearmente. Vale aqui esclarescer que a forma apresentada em \eqref{eq:nlin_models_narmax_generic}
não é uma regressão linear. Para uma regressão linear:

\begin{equation}
y(t)=\theta^T\phi(y(t), u(t))
\label{eq:nlin_models_narmax_reg}
\end{equation}
onde $\phi(\cdot)$ é dependente apenas dos sinais de entrada e saída do sistema, usualmente sendo uma matriz formada a
partir dos dados coletados do sistema. Diferentemente do equacionamento apresentado em
\eqref{eq:nlin_models_narmax_generic}, onde $\Phi_{nl}(\cdot)$ é dependente também do ruído. Outra diferênça está no
fato de que em \eqref{eq:nlin_models_narmax_generic} é possível ter regressores não lineares. Ou seja, é possível ter
combinações lineares e não lineares dos sinais $y(t)$ e $u(t)$ e do vetor de resíduos $e(t)$ até o instante $(t-1)$.
\cite{aguirre}

As funções radiais de base apresentadas na seção (\ref{sec:nl_models_radiais}) por meio da
equação \eqref{eq:nl_models_rbf} podem ser entendidas como um caso particular deste tipo de sistema.

O modelo {\it{NARMAX}} surgiu, ou foi motivado, pelo típico excessivo esforço para a estimativa dos
parâmetros e pela dificuldade em interpretar os resultados obtidos com modelos baseados em séries (Volterra). A
necessidade do uso de entradas espaciais são também uma desvantagem destes modelos. \cite{leontaritis_billings1985}

Quando o vetor $\Phi_{nl}(\cdot)$ é um conjunto de funções polinomiais, o modelo pode ser apresentado como em :

\begin{equation}
y(t)=\sum_{i}c_i \prod_{j=1}^{n_y}y(t-j) \prod_{r=1}^{n_u}u(t-r) \prod_{q=0}^{n_e}e(t-q)
\label{eq:nl_model_narmax_pol}
\end{equation}

Os modelos polinomiais {\it{bilineares}} são casos particulares do modelo polinomial 
\eqref{eq:nl_model_narmax_pol} quando todos os termos não lineares são do tipo 
$y(t-i)u(t-j), \; \forall i,j$. \cite{aguirre}

Modelos racionais são formados pela razão entre dois polinômios:

\begin{equation}
y(t)=\frac{\sum_{i}c_i \prod_{j=1}^{n_y}y(t-j) \prod_{r=1}^{n_u}u(t-r) \prod_{q=0}^{n_e}e(t-q)}
{\sum_{i}d_i \prod_{j=1}^{d_y}y(t-j) \prod_{r=1}^{d_u}u(t-r) \prod_{q=0}^{d_e}e(t-q)} + e(t)
\label{eq:nl_model_narmax_rat}
\end{equation}

Em função de terem uma estrutura mais flexível, os modelos racionais podem vir a ser
mais abrangentes na modelagem de certos sistemas quando comparados com modelos polinomiais.
Entretanto, os modelos racionais são mais sensíveis ao ruído. \cite{aguirre}

%===============================================================================
%===============================================================================
\subsection{Modelo polinomial}
\label{sec:nl_models_narmax_pol}
% Aguirre 343
%===============================================================================

Com relação ao modelo genérico polinomial {\it{NARMAX}} apresentado em \eqref{eq:nl_model_narmax_pol}
duas considerações serão levadas em conta:

\begin{enumerate}
\item O sistema tem um atraso puro de tempo $\tau _d$.
\item Nenhum termo cujo parâmetro tenha que ser estimado pode depender de $e(t)$.
\end{enumerate}

A segunda consideração implica em tornar a equação independente de $e(t)$. O que equivale a dizer
que $q=1$ em \eqref{eq:nl_model_narmax_pol} resultando em:

\begin{eqnarray}\nonumber
y(t) &=& F[ y(t-1), ..., y(t-n_y), u(t-\tau_d), ..., u(t-\tau_d-n_u+1),\\
&& e(t-1), ..., e(t-n_e)] +e(t)
\label{eq:nl_model_narmax_pol_espec}
\end{eqnarray}

onde $e(t)$ indica que todos os efeitos não podem ser bem representados. $F^l\left [ \cdot  \right ]$ é
uma função polinomial de $y(t)$, $u(t)$ e $e(t)$ com grau de não linearidade $l\in \mathbb{N}$. 
Portanto a parte não determinística da equação \eqref{eq:nl_model_narmax_pol_espec} pode ser expandida como
um somatório de termos com grau de não linearidade variando de $1 \le m \le l$. 
Assim sendo, cada termo de grau $m$ poderá conter um valor de grau $p$ do tipo $y(t-i)$
e um fator de grau $(m-p)$ do tipo $u(t-i)$ sendo multiplicado por um parâmetro representado 
por $c_{p,m-p}(n_1, ..., n_m)$. Obtendo: \cite{aguirre}

\begin{equation}
y(t)=\sum_{m=0}^{l}\sum_{p=0}^{m}\sum_{n1, n_m}^{n_y, n_u}c_{p,m-p}(n_1,...,n_m)\prod_{i=1}^{p}y(t-n_i)\prod_{i=p+1}^{m}u(t-n_i)
\end{equation}
sendo que

\begin{equation}
\sum_{n1,n_m}^{n_y,n_u}\equiv \sum_{n_1=1}^{n_y}\cdots\sum_{n_m=1}^{n_y}
\nonumber
\end{equation}
e o limite superior é $n_y$ se o somatório de refere a fatores do tipo $y(t-n_i)$ ou $n_u$ se os fatores forem do tipo
$u(t-n_i)$. 

%===============================================================================
\subsection{Modelo Racional}
\label{sec:nl_models_narmax_rat}
% Aguirre 345
%===============================================================================

Um modelo racional {\it{NARMAX}} tem a seguinte forma geral apresentada em 
\eqref{eq:nl_model_narmax_rat} e de forma simplificada pode ser apresentado como em:


\begin{align}\nonumber
y(t) &=\frac{a(y(t-1), \ldots, y(t-n_y), u(t-1),\ldots, u(t-n_u), }{b(y(t-1), \ldots, y(t-n_y), u(t-1), \ldots, u(t-n_u),}\cdots \\ 
 & \cdots\frac{ e(t-1), \ldots, e(t-n_e))}{e(t-1), \ldots, e(t-n_e))} +e(t)
 \label{eq:nl_model_narmax_rat_simp}
\end{align}

No modelo apresentado em \eqref{eq:nl_model_narmax_rat_simp}, as funções $a(\cdot)$ e $b(\cdot)$
são polinômios e é conveniente definir o numerador e denominador de \eqref{eq:nl_model_narmax_rat_simp} como em:

\begin{equation}
a(t-1)=\sum_{j=1}^{N_n}p_{nj}\theta_{nj}=\psi _n^T(t-1)\theta_n
\label{eq:nl_model_narmax_rat_num}
\end{equation}

\begin{equation}
b(t-1)=\sum_{j=1}^{N_d}p_{dj}\theta_{dj}=\psi _d^T(t-1)\theta_d
\label{eq:nl_model_narmax_rat_den}
\end{equation}
onde $\theta_{nj}$ e $\theta_{dj}$ são os parâmetros dos regressores, possuindo informações até
o instante $t-1$. Desta forma o valor de parâmetros a ser estimados é $N_n + N_d$

A equação \eqref{eq:nl_model_narmax_rat_simp} possui não linearidade nos parâmetros, tornando a
identificação mais complexa por não ser possível utilizar o método dos mínimos quadrados para a
estimativa dos parâmetros. Uma alternativa para este problema é multiplicar a equação
\eqref{eq:nl_model_narmax_rat_simp} pela equação \eqref{eq:nl_model_narmax_rat_den} em ambos os seus
lados. \cite{billings_zhu91}

\begin{equation}
Y(t)=a(t)-y(t)\sum_{j=2}^{den}p_{dj}(t)\theta_{dj}+b(t)e(t)
\nonumber
\end{equation}

\begin{equation}
Y(t)=\sum_{j=1}^{num}p_{nj}(t)\theta_{nj}-\sum_{j=2}^{den}y(t)p_{dj}(t)\theta_{dj}+\zeta (t)
\label{eq:nl_model_narmax_rat_linear_param}
\end{equation}
onde:

\begin{equation}
Y(t)=y(t)p_{d1}\mid_{\theta_{d1}=1} =p_{d1}(t)\frac{a(t)}{b(t)}+p_{d1}(t)e(t)
\nonumber
\end{equation}
e

\begin{equation}
\zeta(t)=b(t)e(t)=\left ( \sum_{j=1}^{den}p_{dj}(t)\theta_{dj} \right )e(t)
\nonumber
\end{equation}

Pelo fato de $e(t)$ ser independente de $b(t)$ e ter média nula, tem-se:

\begin{equation}
E\left [ \zeta(t) \right ]=E\left [ b(t) \right ]E\left [ e(t) \right ]=0
\label{eq:nl_model_narmax_rat_noise_var}
\end{equation}

A equação \eqref{eq:nl_model_narmax_rat_noise_var} mostra que todos os termos $y(t)p_{dj}(t)$
incluem o termo de ruído $e(t)$ através de $y(t)$ que este por sua vez é relacionado com
$\zeta(t)$, o que resultará em polarização dos parâmetros, mesmo que $e(t)$ seja um ruído branco com
média zero. Este é de certa forma o preço que se paga ao linearizar os parâmetros para que seja
possível utilizar o método dos mínimos quadrados. \cite{aguirre}

Uma das maiores desvantagens da modelo racional quando comparado com o modelo polinomial é que o modelo polinomial é
linear nos parâmetros. Muitos resultados para identificação de sistemas lineares podem ser estendidos para modelos
polinomiais não lineares e várias rotinas de determinação de estrutura já foram desenvolvidas. \cite{chen_billings1989}
