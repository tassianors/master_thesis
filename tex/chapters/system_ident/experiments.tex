%===============================================================================
\section{Premissas para o sucesso do experimento de identificação}
\label{sec:sys_ident_experiments}
%===============================================================================
% mains idea of this section:
% unicidade da solução
% persistência de excitação
% não sobre modelagem

Em aplicações de engenharia, deseja-se que a solução de um problema seja única. Desta forma existem algumas
premissas que devem ser satisfeitas para que o processo de identificação consiga atingir seus objetivos.

Devem ser levadas em consideração algumas características sobre o sinal de excitação do sistema e sobre a escolha da
classe de modelos que irá representar o sistema real $\mathcal{S}$.

%===============================================================================
\subsection{Persistência de Excitação}
\label{sec:si_data_persistently_excitation}
% most part of it came from ljung pg 412
%===============================================================================

Um sinal quasi-estacionário $u(t)$, com espectro $\Phi _u(\omega)$ é dito
{\it{persistentemente excitante de ordem n}} se, para todos os filtros de forma:

\begin{equation}
M_n(q)=m_1q^{-1}+...+m_nq^{-n}
\label{eq:si_data_persistence}
\end{equation}

a relação

\begin{equation}
\left | M_n(e^{i\omega}) \right |^2 \Phi_u(\omega)\equiv 0, \;\; \text{implica que}\; M_n(e^{i\omega}) \equiv 0
\label{eq:si_data_persistence_2}
\end{equation}

Outra caracterização pode ser dada em termos da função de covariância $R_u(\tau)$= $u(t)$ é um
sinal quasi-estacionário, e $\bar{R}_n$ uma matriz $n\times n$ definida como:

\begin{equation}
\bar{R}_n=\begin{bmatrix}
R_u(0) & R_u(1) & ... & R_u(n-1)\\ 
R_u(1) & R_u(2) & ... & R_u(n-2)\\ 
\vdots & \vdots & \vdots & \vdots \\ 
R_u(n-1) & R_u(n-2) & ... & R_u(0)
\end{bmatrix}
\label{eq:si_data_persistently_rn}
\end{equation}

Então $u(t)$ é persistentemente excitante de ordem $n$ se e somente se, $\bar{R}_n$ for não singular.
\cite{ljung}

A partir da equação \eqref{eq:si_data_persistence_2} pode-se extrair interpretações mais explícitas.
Uma delas é que a função $M_n(q)$ pode ter no máximo $n-1$ zeros diferentes dentro do círculo 
unitário (desde que um zero esteja sempre na origem). Por isso $u(t)$ é persistentemente excitante de ordem $n$, se o
espectro do sinal de entrada, $\Phi _u(\omega)$, for diferente de de zero em pelo menos $n$ pontos no intervalo $-\pi<
\omega \le \pi$. \cite{ljung} %page 413

Se um sinal quasi-estacionário é filtrado por uma função de transferência estável, então o sinal resultante 
também é um sinal quasi-estacionário e desta forma se ${ \left| { M }_{ n }({ e }^{ j\omega  }) \right|  }^{ 2
}{ \Phi  }_{ u }(\omega )$ é o espectro do sinal $\nu (t)={ M }_{ n }(q)u(t)$ então este sinal não perde sua
persistência de excitação se filtrado pelo filtro  ${ M }_{ n }(q)$.

Considere o somatório de senoides em \eqref{eq:si_data_persistently_sum_cos}. Cada uma possui duas linhas espectrais em
$\pm \, \omega_k$. Este sinal é então persistentemente excitante de ordem $2n$.

\begin{equation}
u(t)=\sum_{k=1}^{n}\mu_k \cos (\omega_kt), \;\; \omega_k \neq \omega_j, \;\; \omega_k \neq 0, \; \omega_k \neq \pi
\label{eq:si_data_persistently_sum_cos}
\end{equation}

%===============================================================================
\subsection{Experimentos Informativos}
% most part of it came from ljung pg 414
%===============================================================================

Na Seção \ref{sec:si_data_persistently_excitation} foi visto como caracterizar
sinais que são suficiente informativos. Considere um conjunto de modelos ($\mathcal{M}$) para um sistema 
SISO descrito por (\ref{eq:si_intro_model}) tendo a função de transferência $G(q,\theta)$ a
função racional apresentada em (\ref{eq:si_data_g_rational}):

\begin{equation}
G(q,\theta)=\frac{B(q,\theta)}{F(q,\theta)}=\frac{q^{n_k}(b_1+b_2q^{-1}+...+b_{nb}q^{-nb+1})}{1+f_1q^{-1}+...+f_{nf}q^{-nf}}
\label{eq:si_data_g_rational}
\end{equation}

Um experimento em malha aberta com entrada persistentemente excitante de ordem $nb +nf$ é
suficientemente informativo com relação a $\mathcal{M}$.

Um experimento em malha aberta é informativo se a sua entrada for persistentemente excitante.
Observa-se que é necessário que a ordem de excitação seja igual ao número de parâmetros a
serem estimados. \cite{ljung}

Garantir a persistência de excitação para um sinal utilizado na identificação de um sistema é garantir que
o sinal terá componentes de frequência suficientes para excitar o sistema ao ponto de ser possível observar sua dinâmica
de forma satisfatória. Inclui-se desta forma na identificação informações suficientes para que todos os
parâmetros da família de modelos possam ser identificados.

%===============================================================================
\subsection{Escolha do modelo e sobremodelagem}
%===============================================================================

Um aspecto comumente indesejado para aplicações de engenharia é quando a solução do problema não possui apenas uma
solução. A escolha de um conjunto de modelos $\mathcal{M}$ onde a ordem do modelo é maior do que a ordem do sistema real
$\mathcal{S}$ faz com que existam infinitas combinações de $\theta$, resultando em infinitos modelos dentro do conjunto
$\mathcal{M}$ que conseguem descrever exatamente o sistema $\mathcal{S}$:

\begin{equation}
\mathcal{S}\subset \mathcal{M}
\label{eq:si_exper_overfit}
\end{equation}

A escolha de uma classe de modelos $\mathcal{M}$ é o ponto mais crucial para que o processo de identificação de sistemas
tenha sucesso. Esta escolha deve ser com base no entendimento do procedimento de identificação e das percepções e
conhecimentos que se tem sobre o sistema a ser identificado. \cite{ljung}

O preço ou custo de uma classe de modelos pode ser mensurada em alguns aspectos e a escolha da classe de modelos se dará
por alguma ponderação sobre estes critérios, que podem ser: \cite{ljung}

\begin{itemize}
  \item Flexibilidade: Usando classes de modelos que tenham boas capacidades de descrever tipos diferentes de sistemas.
  flexibilidade pode ser obtida usando-se vários parâmetros ou alocando-os em ``posições estratégicas''.
  \item Parsimonia: Não usar desnecessáriamente uma quantidade elevada de parâmetros.
  \item Complexidade do algoritmo: A complexidade de obter o erro de predição $\varepsilon (t, \theta)$ e as demais
  informações necessárias a identificação são extremamente correlacionadas com a escolha de $\mathcal{M}$.
  \item Propriedades da função critério. Dependendo do formato da curva, o algortimo para encontrar o mínimo pode ser
  mais custoso no que diz respeito a iterações matemáticas.
  \item O uso pretendido do modelo.
\end{itemize}

O uso de classes de modelos com diversos parâmetros só deve ser utilizado se modelos com menos parâmetros não passaram
pelos testes de validação do modelo escolhido. Desta forma mantem-se a idéia de que quanto mais simples melhor,
garantindo a parsimônia da classe escolhida e conseguindo cumprir com o uso pretendido do sistema.

Uma das primeiras justificativas para o desenvolvimento de métodos para a escolha de classes de modelos é a
dificuldade em trabalhar com classes de modelos com muitos parâmetros, pelas complexibilidade adicionada aos algoritmos
e as incertezas matemáticas inseridas. Além disso existe o problema destes modelos serem numericamente mal
condicionados além da convicção de que são redundantes e poderiam ser removidos do modelo (aplicando algum algoritmo de
simplificação de modelo). Um modelo com um número excessivo de parâmetros pode exibir dinâmicas que não são observadas
no sistema real, desta forma não existe apenas o problema numérico para a identificação, mas também um problema de
dinâmica em utilizar um modelo sobre-estimado.
\cite{aguirre_jacome}

O procedimento que testa se a classe de modelos é simples e apropriada para descrever o sistema é aplicar alguma tecnica
de redução a claase de modelos. Se a ordem da classe de modelos pode ser reduzida sem afetar as propriedades de etrada e
saída do sistema, então a classe de modelos original era desnecessáriamente complexa. \cite{ljung}

Por fim, ao escolher uma classe de modelos para a identificação, deve-se leavr em conta diversos pontos e informações.
Depois de escolhido este modelo, um processo de validação do modelo é indicado a ser executado. Este procedimento é
simples e concistem em algumas perguntas que o projetista do experimento de identificação deve fazer:

\begin{itemize}
  \item A classe de modelos escolhida consegue descrever suficientemente bem os dados observados?
  \item A classe de modelos é boa suficiente para meus objetivos?
  \item A classe de modelos descreve o sistema real ($\mathcal{S}$) ?
\end{itemize}

