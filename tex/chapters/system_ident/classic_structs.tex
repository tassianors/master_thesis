%===============================================================================
\section{Estruturas clássicas}
\label{sec:sys_ident_classic_structs}
%===============================================================================
% mains idea of this section:
% ARX ARMAX \ldots

Modelos são formas ou representações de como vemos e entendemos os sistemas.
Para um mesmo sistema podemos ter diversos modelos, portanto, modelos são
fundamentais para o conhecimento, para a análise, para o controle de sistemas. \cite{aguirre}

Existem dois principais ramos para modelagem de sistemas, um deles parte-se do
conhecimento intrínseco do mesmo para obter-se o modelo, enquanto que o outro
não possui este pré-requisito, focando-se em técnicas que tornem o processo de
modelagem o mais independente possível da necessidade de se conhecer o sistema,
antes de modela-lo.  Estes dois processos são conhecidos como
{\it{Modelagem caixa branca}} e {\it{Modelagem caixa preta}} respectivamente.

No caso de modelagem caixa branca, faz-se necessário conhecer a fundo o sistema
modelado. Além de estar bem familiarizado com o sistema é necessário conhecer as
relações matemáticas que descrevem os fenômenos envolvidos. \cite{aguirre}.

Para o caso de modelagem caixa preta exige-se que pouco ou nenhum conhecimento prévio
do sistema seja necessário. Este tipo de técnica é também conhecida como {\it{modelagem empírica}}.

Algo importante a se destacar antes do processo de modelagem do sistema é a
escolha do que deseja-se modelar deste sistema. Uma modelagem completa de todas
as características é muitas vezes inviável e na maioria dos sistemas reais,
desnecessário. Usualmente, temos a necessidade de interagir, seja controlando ou
observando, um conjunto restrito de informações do sistema, deve-se então focar
o modelo nestas características desejadas.

%===============================================================================
\subsection{Forma geral de famílias de modelos}
\label{sec:si_modeling_family_models}
%===============================================================================

Modelo de um sistema é a descrição matemática de {\it{algumas}} de suas propriedades. 

Na seção (\ref{sec:sys_ident_intro}) apresentou-se a definição para um conjunto de modelos:

\begin{equation}
\mathcal{M}: \;\;\left \{ G(q, \theta), H(q, \theta) | \theta \in D_{\mathcal{M}} \right \}
\nonumber
\end{equation}

Resultando em um sistema que pode ser descrito como abaixo: 

\begin{equation}
y(t)=G(q, \theta)u(t)+H(q, \theta)e(t)
\end{equation}

Onde as funções de transferência $G(q, \theta)$ e $H(q, \theta)$  são parametrizadas por $\theta$ e para cada
combinação de $\theta$, um novo modelo é definido. Pode-se desta forma defini-los como:

\begin{equation}
G(q, \theta)=\sum_{k=1}^{\infty}g(k, \theta)q^{-k}
\nonumber
\end{equation}

\begin{equation}
H(q, \theta)=1+\sum_{k=1}^{\infty}h(k, \theta)q^{-k}
\nonumber
\end{equation}

Uma forma direta para a identificação de sistemas é tornar as funções $G(q, \theta)$ e $H(q, \theta)$ em funções
racionais e os coeficientes do denominador e numerador destes polinômios sejam os objetivos do processo de identificação
($\theta$).

Provavelmente o modelo mais simples para descrever a relação entre entrada e saída de um sistema seja obtido
descrevendo-o como uma equação linear (\ref{eq:si_modeling_arx}). \cite{ljung}

\begin{equation}
y(t)+a_1 y(t-1)+...+a_{na} y(t-n_a)= b_1 u(t-1)+...+b_{nb} u(t-n_b)+e(t)
\label{eq:si_modeling_arx}
\end{equation}

O ruido branco $e(t)$ aqui entra como um erro direto na equação. Os parâmetros ajustáveis neste caso são:

\begin{equation}
\theta = \begin{bmatrix}
a_1 & a_2 & ... & a_{na} & b_1 & ... & b_{nb} 
\end{bmatrix}^T
\end{equation}

Definem-se os polinômios:

\begin{equation}
A(q)=1+a_1q^{-1}+...+a_{na}q^{-n_a}
\nonumber
\end{equation}

\begin{equation}
B(q)=b_1q^{-1}+...+b_{nb}q^{-n_b}
\nonumber
\end{equation}

O modelo definido em (\ref{eq:si_modeling_arx}) também é conhecido como {\bf{ARX}}, onde {\it{AR}} refere-se 
à parte de $A(q)y(t)$ auto-regressiva, e {\it{X}} como a entrada extra $B(q)u(t)$.

Uma das limitações deste modelo é a falta de liberdade para descrever as propriedades
dos distúrbios sobre o sistema. Pode-se então adicionar certo grau de liberdade descrevendo a equação do erro 
como uma média móvel do ruído branco, isso nos remete a (\ref{eq:si_modeling_armax}).

\begin{equation}
\begin{matrix}
y(t) & +a_1 y(t-1)+...+a_{na} y(t-n_a)= b_1 u(t-1)+...+b_{nb} u(t-n_b)\\ 
 & +e(t) +c_1 e(t-1)+...+c_{nc} e(t-n_c)
\end{matrix}
\label{eq:si_modeling_armax}
\end{equation}

Define-se o polinômio que filtra o ruído como:

\begin{equation}
C(q)=1+c_1q^{-1}+...+c_{nc}q^{-n_c}
\nonumber
\end{equation}

E as funções de transferência como abaixo:

\begin{equation}
G(q, \theta)=\frac{B(q)}{A(q)} , \;\;
H(q, \theta)=\frac{C(q)}{A(q)}
\label{eq:si_modeling_lti_det_armax}
\end{equation}

Tem-se então que os parâmetros à estimar são:

\begin{equation}
\theta = \begin{bmatrix}
a_1 & a_2 & ... & a_{na} & b_1 & ... & b_{nb} & c_1 & ... & c_{nc}
\end{bmatrix}^T
\end{equation}

O modelo definido em (\ref{eq:si_modeling_armax}) também é conhecido como {\bf{ARMAX}}, onde {\it{MA}} define 
a média móvel $C(q)$ do ruido $e(t)$.

Na figura (\ref{fig:si_models_diagram_narmax}) é apresentado o diagrama de blocos para o modelo {\bf{ARMAX}}.

\begin{figure}[htbp]
\center
% Generated with LaTeXDraw 2.0.8
% Wed May 23 23:07:49 BRT 2012
% \usepackage[usenames,dvipsnames]{pstricks}
% \usepackage{epsfig}
% \usepackage{pst-grad} % For gradients
% \usepackage{pst-plot} % For axes
\scalebox{1} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-4.4)(9.02,4.42)
\psframe[linewidth=0.04,dimen=outer](3.4,1.8)(1.6,0.6)
\psline[linewidth=0.04cm](5.6,4.4)(5.6,3.6)
\psline[linewidth=0.04cm](1.6,1.2)(0.0,1.2)
\psline[linewidth=0.04cm](3.4,1.2)(5.2,1.2)
\pscircle[linewidth=0.04,dimen=outer](5.6,1.2){0.4}
\psline[linewidth=0.04cm](5.6,2.6)(5.6,1.6)
\psline[linewidth=0.04cm](6.0,1.2)(8.0,1.2)
\psline[linewidth=0.04cm](2.4,-3.8)(4.0,-3.8)
\pscircle[linewidth=0.04,dimen=outer](4.4,-3.8){0.4}
\psline[linewidth=0.04cm](4.4,-2.4)(4.4,-3.4)
\psline[linewidth=0.04cm](4.8,-3.8)(6.6,-3.8)
\psline[linewidth=0.04cm](4.4,-1.4)(4.4,-0.6)
\psframe[linewidth=0.04,dimen=outer](7.8,-3.2)(6.6,-4.4)
\psline[linewidth=0.04cm](1.2,-3.8)(0.0,-3.8)
\psline[linewidth=0.04cm](9.0,-3.8)(7.8,-3.8)
\usefont{T1}{ptm}{m}{n}
\rput(0.689375,1.51){u(t)}
\usefont{T1}{ptm}{m}{n}
\rput(7.499375,1.51){y(t)}
\usefont{T1}{ptm}{m}{n}
\rput(6.0946875,4.11){e(t)}
\usefont{T1}{ptm}{m}{n}
\rput(0.489375,-3.49){u(t)}
\usefont{T1}{ptm}{m}{n}
\rput(4.8946877,-0.89){e(t)}
\usefont{T1}{ptm}{m}{n}
\rput(8.499375,-3.49){y(t)}
\usefont{T1}{ptm}{m}{n}
\rput(4.3745313,-3.81){$\sum$}
\usefont{T1}{ptm}{m}{n}
\rput(5.594531,1.21){$\sum$}
\usefont{T1}{ptm}{m}{n}
\rput(1.8045312,-3.81){$\frac{B(q)}{F(q)}$}
\usefont{T1}{ptm}{m}{n}
\rput(7.284531,-3.79){$\frac{1}{A(q)}$}
\usefont{T1}{ptm}{m}{n}
\rput(4.3945312,-1.89){$\frac{C(q)}{D(q)}$}
\usefont{T1}{ptm}{m}{n}
\rput(2.5145311,1.21){$\frac{B(q)}{A(q)F(q)}$}
\usefont{T1}{ptm}{m}{n}
\rput(5.5645313,3.11){$\frac{C(q)}{A(q)D(q)}$}
\psframe[linewidth=0.04,dimen=outer](5.0,-1.4)(3.8,-2.4)
\psframe[linewidth=0.04,dimen=outer](2.4,-3.2)(1.2,-4.4)
\psframe[linewidth=0.04,dimen=outer](6.6,3.6)(4.6,2.6)
\usefont{T1}{ptm}{m}{n}
\rput(0.80921876,3.71){(a)}
\usefont{T1}{ptm}{m}{n}
\rput(0.81921875,-1.29){(b)}
\end{pspicture} 
}
\caption{Diagrama de blocos do conjunto ARMAX de modelos. Ambos os diagramas são equivalentes.}
\label{fig:si_models_diagram_narmax}
\end{figure}

Onde:

\begin{equation}
G(q, \theta)=\frac{B(q)}{A(q)F(q)}
\nonumber
\end{equation}

\begin{equation}
H(q, \theta)=\frac{C(q)}{A(q)D(q)}
\nonumber
\end{equation}

A partir do equacionamento do sistema apresentado em \eqref{eq:si_modeling_lti_det_armax} e \eqref{eq:si_intro_system}
pode-se facilmente generalizar para o equacionamento apresentado em \eqref{eq:si_modeling_lti_det_global}.

\begin{equation}
A(q)y(t)=\frac{B(q)}{F(q)}u(t)+\frac{C(q)}{D(q)}e(t)
\label{eq:si_modeling_lti_det_global}
\end{equation}

Quando usam-se apenas um conjunto dos polinômios de $A(q) \; \cdot \; F(q)$ obtemos as estruturas de modelos
da Tabela \ref{table:si_modeling_models}.

\begin{table*}[htbp]
\begin{center}
\caption{Alguns modelos comuns para sistemas SISO. Casos especias de \eqref{eq:si_modeling_lti_det_global}}
\label{table:si_modeling_models}
\begin{tabular}{cl}
\hline
        Polinômios usados em \eqref{eq:si_modeling_lti_det_global} & Mome da estrutura do modelo   \\
\hline
        B                 & FIR (finite impulse response) \\ 
        AB                & ARX                           \\ 
        ABC               & ARMAX                         \\ 
        AC                & ARMA                          \\ 
        ABD               & ARARX                         \\ 
        ABCD              & ARARMAX                       \\ 
        BF                & OE (output error)             \\ 
        BFCD              & Box-Jenkins                   \\
\hline
\end{tabular}
\end{center}
\end{table*}

As equações que descrevem a saída do sistema em função da entrada $u(t)$ e do ruido $e(t)$ como apresentado
em \eqref{eq:si_intro_system} e que podem ser caracterizados pela utilização de vários polinômios, nada mais
são do que famílias ou conjuntos de modelos.
Existe para cada conjunto de modelos uma infinidade de possíveis saídas para uma mesma entrada, bastando para
isso que os parâmetros dos coeficientes dos polinômios sejam escolhidos apropriadamente. O objetivo na
identificação de sistemas é encontrar um conjunto de coeficientes que consiga melhor descrever os dados
observados na saída, para o maior conjunto de sinais de entrada possíveis.
