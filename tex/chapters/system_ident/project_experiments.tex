%===============================================================================
\section{Projeto de Experimento}
\label{sec:si_project_experiments}
%===============================================================================

Projeto de experimentos pode ser entendido como o procedimento para que se escolha o melhor 
sinal de entrada para a identificação dos parâmetros desejados para o experimento. 
Desta forma muitas variáveis podem ser levadas em consideração, refletindo em propriedades que
podem ou não ser o foco do projeto de experimentos.

Uma forma de organizar o projeto de experimento é desenvolve-lo como um problema de otimização 
convexa, onde entre muitas vantagens está o fato de que é possível a utilização de métodos matemáticos
para o seu cálculo e sua formulação pode ser feita por LMI ({\it{Linear Matrix Inequality}}. Em \cite{jansson}
este tópico é explorado em mais profundidade, sendo aqui apenas apresentado a sua ideia básica.

O projeto de experimento é uma alternativa ao uso de sinais como PRBS ({\it{Pseudo Randon Binary Sequence}}).
A escolha de um sinal mais apropriado para o experimento traz diversas vantagens, que podem ser bastante
significativas para o tempo e esforço despendido sobre o projeto do controlador, ou da identificação do sistema.
Uma destas vantagens é o tempo de dados coletados, aplicando-se sinais com componentes de frequência que são
mais informativos, tem-se uma eficiência maior nos dados amostrados, bastando um montante menor de data, para que
sejam obtidos os mesmos índices de qualidade, quando comparado com projetos utilizando sinais mais simples.

%===============================================================================
\subsection{Sinais de entrada mais comumente utilizados}
\label{sec:si_project_signal_input}
%===============================================================================

Como foi apresentado no capítulo (\ref{sec:si_data_persistently_excitation}) é
possível formar sinais persistentes, apenas adicionando um número suficiente de componentes
de frequência a fim de que todos os parâmetros possam ser estimados. Não é estranho
que se pense que quanto mais componentes tiver o sinal, melhor. 

Desta maneira, vários sinais que podem ser gerados de maneira fácil e que possuem 
um grande range de componentes de frequência foram elaborados.

%===============================================================================
\subsubsection{Sinal Binário Randômico}
\label{sec:si_project_signal_input_rbs}
%===============================================================================

Um sinal binário por definição assume apenas dois valores (0 ou 1). Partindo deste
principio, um sinal binário randômico, é uma sequencia aleatória de zeros e uns, que
formam o sinal.

A forma mais simples para a gerar este sinal é, baseado em um ruído Gausiano branco
de média zero, aplicar um filtro linear previamente escolhido. Assim pode-se teoricamente
gerar qualquer sinal binário de qualquer nível.

O inconveniente desta forma é que aplicando um filtro ao sinal Gausiano irá alterar o
seu espectro, não sendo a forma desta alteração algo conhecido. Deve-se então sempre 
antes de aplicar o sinal no sistema, verificar o espectro gerado. \cite{ljung}

%===============================================================================
\subsubsection{Sinal Binário Pseudo-Randômico - PRBS}
\label{sec:si_project_signal_input_prbs}
%===============================================================================
% ref: ljung pages 418

Um {\it{sinal binário pseudo-randômico}} é um sinal periódico com algumas propriedades
semelhantes a de ruído branco. Este sinal é gerado pela equação \eqref{eq:si_project_signal_prbs}.

\begin{equation}
u(t)=rem(A(z)u(t), 2)=rem(a_1 u(t-1)+...+a_n u(t-n), 2)
\label{eq:si_project_signal_prbs}
\end{equation}
onde $rem(x, 2)$ é o resto inteiro da divisão de $x$ por 2. O sinal $u(t)$ deve ser periódico 
de pelo menos $2^n$ valores diferentes, como uma sequencia de zeros não é um sinal válido, por ser nulo, 
temos que o máximo período é de tamanho $M=2^n -1$. Na verdade o período vai depender da
escolha de $A(z)$. Pode-se entretanto mostrar que para cada $n$ existem escolhas de $A(z)$ que 
proporcionam o tamanho máximo. Tais escolhas são apresentadas na Tabela \ref{table:si_project_input_prbs}.
\cite{ljung}

\begin{table*}[htbp]
\begin{center}
\caption{Polinômios $A(z)$ que geram o máximo período $M$ para sinais PRBS de ordem $n$. $a_k=1$ para os $k$
   	indicados, 0 para os demais. Diversas outras escolhas existem para os mesmos $n$.}
\label{table:si_project_input_prbs}
\begin{tabular}{ccc}
\hline
        Ordem $n$ & $M=2^n-1$ & $a_k$ não zeros para $k$   \\
\hline
        2       & 3        & 1, 2       \\
        3       & 7        & 2, 3       \\
        4       & 15       & 1, 4       \\
        5       & 31       & 2, 5       \\
        6       & 63       & 1, 6       \\
        7       & 127      & 3, 7       \\
        8       & 255      & 1, 2, 7, 8 \\
        9       & 511      & 4, 9       \\
        10      & 1023     & 7, 10      \\
        11      & 2047     & 9, 11      \\
\hline
\end{tabular}
\end{center}
\end{table*}

O espectro de um sinal PRBS é dado por:

\begin{equation}
\Phi_u(\omega)=\frac{2 \pi \bar{u}^2}{M}\sum_{k=1}^{M-1}\delta (\omega -2 \pi k/M), \;\; 0\le \omega < 2 \pi
\label{eq:si_project_signal_prbs_spectrum}
\end{equation}

Observa-se que este é um sinal persistentemente excitante de ordem $M-1$. Na Figura 
\ref{fig:si_project_prbs} é apresentado um exemplo de sinal PRBS para $n=7$.

\begin{figure}[htbp]
	\center
	\includegraphics[width=0.95\columnwidth]{figures/si_project_prbs.eps}
	\caption{Sinal PRBS para $n=7$}
	\label{fig:si_project_prbs}
\end{figure}

As vantagens e desvantagens do sinal PRBS comparado com um ruído randômico binário pode ser
listado: \cite{ljung}

\begin{enumerate}[(I)]
\item Se o PRBS possuir períodos inteiros a sua matriz de covariância terá alguns padrões bem específicos que permitem 
analiticamente se faça uma inversão desta matriz. Isso facilita certas computações.
\item Existem essencialmente apenas um PRBS para cada escolha de $A(z)$. Diferentes valores iniciais apenas deslocam a
sequencia.
\item Para que as propriedades vantajosas do PRBS possam ser utilizadas, é necessário que um numero inteiro de períodos
seja utilizado, o que limita a escolha do tamanho do experimento.
\end{enumerate}

%===============================================================================
\subsubsection{Ruido Branco Filtrado}
\label{sec:si_project_signal_input_wn_filtered}
%===============================================================================

Um das escolhas mais simples de sinais, é gerar um ruído Gausiano e então filtra-lo com 
algum filtro linear. Desta forma, teoricamente, é possível de se atingir qualquer espectro de
sinal, bastando apenas a correta escolha do filtro. Como este sinal é gerado {\it{off-line}}, 
é possível aplicar filtros não causais e eliminar efeitos transientes do sinal, o que
proporciona um comportamento espectral melhor. \cite{campestrini, ljung}

%===============================================================================
\subsection{Projeto de experimento como um problema de otimização}
\label{sec:si_project_optimization}
%===============================================================================

O problema de projeto de experimento pode ser considerado como uma forma geral apresentada em \eqref{eq:si_project_optimization}

\begin{equation}
\begin{matrix}
\underset{\Phi_{\chi_0}}{\text{minimize}} &  & \text{Objetivo}\\ 
\text{Sujeito a:} &  & \text{Requisitos de qualidade}\\ 
 &  & \text{Requisitos de sinais}
\end{matrix}
\label{eq:si_project_optimization}
\end{equation}

De forma geral os requisitos de qualidades são funções da covariância de $P$. Por esta razão é natural usar
o espectro da entrada $\Phi_u$ e eventualmente o espectro cruzado $\Phi_{ue}$ como variáveis do projeto.
A inclusão de limitações nos sinais e sua inclusão como variáveis de projeto são úteis para evitar que se chegue
em resultados onde a energia de entrada precise ser infinita para se obter os critérios desejados, ou largura
de banda que não são facilmente atingíveis em projetos reais.

Típicos projetos de experimentos são intratáveis em sua forma original, pelos seguintes motivos: \cite{jansson}

\begin{enumerate}[(I)]
\item Algumas restrições são tipicamente não convexas, e problemas com estas características podem ser difíceis
de resolver.
\item Existem restrições que são de dimensão infinita, o que exigem um certo grau de cuidado no procedimento de
otimização.
\item Existe ainda o problema de encontrar um sinal realizável que tenha as propriedades desejadas para o espectro.
\item A variância assintótica depende tipicamente dos parâmetros do sistema $\theta_0$, $P=P(\theta_0s)$ que são
desconhecidos.
\end{enumerate}

Os primeiros 3 itens listados acima são contornáveis pela inserção de uma parametrização finita do espectro de entrada
e algumas vezes até do espectro cruzado, tornando o problema convexo, que pode ser tratado de forma bem mais fácil.

O último item onde a solução do problema depende das características do sistema a ser identificado é intrínseco de quase
todos os problemas de otimização, sendo então inevitável. Em problemas reais este fato pode ser contornado utilizando alguns
métodos conhecidos. \cite{jansson}

A formulação de um projeto de experimento pode ser particionado nas seguintes partes:

\renewcommand{\labelitemi}{$\bullet$}
\begin{itemize}

\item {\it{Parametrização do espectro}}

A escolha de usar uma parametrização finita do espectro ou uma parametrização parcial da correlação é regido pelos seguintes
aspectos:

\begin{itemize}
\item relativos a otimização
\item Computacionais
\item limitação de sinais
\item robustez
\end{itemize}

A parametrização parcial da correlação é ótima e pode usar um número mínimo de parâmetros, utilizando assim, menos processamento
computacional. Entretanto certas limitações de sinais não podem ser garantidas nesta situação, e a parametrização
pode depender do sistema real. Parametrização finita do espectro geralmente não atinge um mínimo global mas as funções bases
não precisam ser funções do sistema real. Este método pode gerenciar problemas de limitações de sinal de frequência por frequência.
%-------------------------
\item {\it{Restrições de qualidade}}

Assumindo que erros de variância são de grande importância é natural que qualquer medida de qualidade do modelo leve em conta 
a matriz de covariância $P$. Esta matriz pode ser manipulada pelos espectros de entrada $\Phi_{u}$ e o espectro cruzado $\Phi_{ue}$
como apresentado em \eqref{eq:si_project_optimization_quality}.

\begin{equation}
P^{-1}(\theta_0)=\frac{1}{2 \pi \lambda_0}\int_{-\pi}^{\pi}\mathcal{F}(e^{j\omega}, \theta_0)\begin{bmatrix}
\Phi_u(\omega) & \Phi_{ue}(\omega)\\ 
\Phi_{ue}^{0}(\omega) & \lambda_0 
\end{bmatrix}\mathcal{F}(e^{j\omega}, \theta_0)\;d\omega
\label{eq:si_project_optimization_quality}
\end{equation}

O principal desafio neste ponto é tornar as restrições convexas em $P^{-1}$.

%-------------------------
\item {\it{Restrições de sinal}}

Podem ser incluídos, restrições de energia para os sinais de entrada e saída do sistema bem como restrições no sinal dependentes da
frequência deste.
%-------------------------
\item {\it{Restrições de robustez}}

A solução de boa parte dos problemas de otimização recaem na necessidade de se conhecer o sistema real. Isso nem sempre é possível 
e uma das formas de contornar este problema é substituir o sistema real por uma aproximação deste. Devido aos erros de estimativa deste
sistema, tem-se a necessidade de se utilizar métodos que garantam robustez deste sistema, para que quando submetido ao sistema real, 
o projeto ainda seja válido.
%-------------------------
\end{itemize}


