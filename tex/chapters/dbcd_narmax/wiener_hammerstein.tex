%===============================================================================
\section{Wiener / Hammerstein}
\label{sec:dbnarmax_wiener_hammerstein}
%===============================================================================

Nesta seção serão apresentados os resultados obtidos e os procedimentos para a identificação de controladores não
lineares modelados por classe de modelos polinomiais quando a planta $\mathcal{S}_{nl}$ é um sistema não linear do tipo
Wiener. Será utilizado o conceito de referência virtual para a obtenção dos sinais necessários para que o projeto de
identificação deste controlador possa ser realizado.

Considere que o sistema real possui uma não linearidade estática do tipo Wiener, onde o bloco não linear
encontra-se na saída do processo. Como descrito em:

\begin{eqnarray}
z(t) & = & G_0(q) u(t) + H_0 (q) e(t) \label{eq:wiener_z} \\
y(t) & = & \zeta( z(t)) \label{eq:wiener_y}
\end{eqnarray}
onde $G_0(q)$ e $H_0(q)$ são funções de transferência racionais e o mapa  $\zeta(\cdot ):
{\cal D}\rightarrow \cal D$, com $\cal D\subset \Re$, é analítico. A Figura \ref{fig:Wiener} representa este sistema.

\begin{figure}[htbp]
\center
% Generated with LaTeXDraw 2.0.8
% Tue Sep 04 00:22:08 BRT 2012
% \usepackage[usenames,dvipsnames]{pstricks}
% \usepackage{epsfig}
% \usepackage{pst-grad} % For gradients
% \usepackage{pst-plot} % For axes
\scalebox{1} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-1.0367187)(6.8690624,1.0767188)
\pscircle[linewidth=0.04,dimen=outer](3.17,-0.63671875){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.37,-0.63671875)(1.17,-0.63671875)
\psframe[linewidth=0.04,dimen=outer](2.37,-0.23671874)(1.17,-1.0367187)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.37,-0.63671875)(4.37,-0.63671875)
\psframe[linewidth=0.04,dimen=outer](5.57,-0.23671874)(4.37,-1.0367187)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(2.37,-0.63671875)(2.97,-0.63671875)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(5.57,-0.63671875)(6.37,-0.63671875)
\usefont{T1}{ppl}{m}{n}
\rput(3.7245312,-0.32671875){$z(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(0.48453125,-0.32671875){$u(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(6.284531,-0.32671875){$y(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(4.934531,-0.62671876){$\zeta(\cdot)$}
\usefont{T1}{ppl}{m}{n}
\rput(1.7345313,-0.62671876){$G_0(q)$}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.37,0.56328124)(1.17,0.56328124)
\psframe[linewidth=0.04,dimen=outer](2.37,0.9632813)(1.17,0.16328125)
\psline[linewidth=0.04cm](2.37,0.56328124)(3.17,0.56328124)
\usefont{T1}{ppl}{m}{n}
\rput(0.48453125,0.87328124){$e(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(1.7345313,0.59328127){$H_0(q)$}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.17,0.56328124)(3.17,-0.43671876)
\end{pspicture} 
}
\caption{Um sistema do tipo Wiener como descrito por \eqref{eq:wiener_z} e \eqref{eq:wiener_y}}
\label{fig:Wiener}
\end{figure}

Além disso é assumido que a função $\zeta(\cdot )$ é inversível em todo range $\cal D$, ou seja, existe uma função
$\zeta_R^{-1}(\cdot )$ tal que $\zeta(\zeta_R^{-1}(x)) = x \quad \forall x \in {\cal D}$.

Não é difícil de perceber que para este caso o controlador ideal é um sistema Hammerstein, ou seja:

\begin{eqnarray}
u(t) & = & C_d'(q) v(t)  \label{eq:hammer_u}\\
v(t) & = & r(t) - \gamma( y(t) )\label{eq:hammer_v}
\end{eqnarray}

\begin{figure}[htbp]
\center
% Generated with LaTeXDraw 2.0.8
% Sun Sep 02 10:59:53 BRT 2012
% \usepackage[usenames,dvipsnames]{pstricks}
% \usepackage{epsfig}
% \usepackage{pst-grad} % For gradients
% \usepackage{pst-plot} % For axes
\scalebox{1} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-1.0367187)(4.6990623,1.0767188)
\pscircle[linewidth=0.04,dimen=outer](1.2,0.56328124){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,0.56328124)(1.0,0.56328124)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.4,0.56328124)(2.2,0.56328124)
\psframe[linewidth=0.04,dimen=outer](3.4,0.9632813)(2.2,0.16328125)
\psline[linewidth=0.04cm](1.2,-0.63671875)(2.2,-0.63671875)
\psframe[linewidth=0.04,dimen=outer](3.4,-0.23671874)(2.2,-1.0367187)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.2,-0.63671875)(1.2,0.36328125)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.4,0.56328124)(4.2,0.56328124)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{<-}(3.4,-0.63671875)(4.2,-0.63671875)
\usefont{T1}{ptm}{m}{n}
\rput(0.48453125,0.87328124){$r(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(4.114531,0.87328124){$u(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(4.114531,-0.32671875){$y(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(1.7145313,0.87328124){$v(t)$}
\usefont{T1}{ptm}{m}{n}
\rput(2.7645311,-0.62671876){$\gamma(\cdot)$}
\usefont{T1}{ptm}{m}{n}
\rput(2.7745314,0.5732812){$C_d'(z)$}
\psline[linewidth=0.04cm](1.38,0.34328124)(1.54,0.34328124)
\end{pspicture} 
}
\caption{Um controlador do tipo Hammerstein como descrito por \eqref{eq:hammer_u} e \eqref{eq:hammer_v}}
\label{fig:dbnarmax_method_vr}
\end{figure}

Realmente, se $\gamma(\cdot ) = \zeta_R^{-1}(\cdot )$ e 
\begin{equation}
C_d' (q)= \frac{T_d(q)}{G_0(q)(1-T_d(q))}
\label{eq:dbcd_perf_tracking_cd}
\end{equation}
então o sistema em malha fechada é linear com uma função de transferência $T_d(q)$.

Na prática esta é uma solução padrão de controle, pois controladores comerciais normalmente incluem customizáveis
funções de linearização  $\gamma(\cdot )$  no laço de realimentação. Fica claro que mesmo neste caso padrão o controlador
ideal não é uma função do erro de referência $r(t)-y(t)$, mas sim uma função de  $r(t)$ e de $y(t)$ separadamente. 

Assumindo que a referência é uma constante conhecida, uma topologia alternativa pode ser elaborada com um controlador
que é dependente apenas do erro de referência. A classe de modelos deste controlador pode ser definido como:

\begin{eqnarray}
u(t) & = & C'(q,\theta) v(t) \label{eq:track_error_controller_u}\\
v(t) & = & \gamma( r(t) - y(t),\eta )\label{eq:track_error_controller_v}
\end{eqnarray}
onde a função $\gamma(\cdot,\cdot )$ deve ser tal que o sistema com o controlador em malha fechada deve se comportar
como se nenhuma das não linearidades estivesse presente, ou seja:

\begin{equation}
\gamma ( r(t) - y(t) ) = \alpha [r(t)-z(t)]
\label{vzlinear}
\end{equation}
para algum $\alpha\in\Re^+$. 

A Figura \ref{fig:vrft_nl_wiener} mostra um sistema com uma não linearidade do tipo Wiener e um controlador descrito
como anteriormente.

\begin{figure}[htbp]
\center
% Generated with LaTeXDraw 2.0.8
% Sat Aug 25 13:00:53 BRT 2012
% \usepackage[usenames,dvipsnames]{pstricks}
% \usepackage{epsfig}
% \usepackage{pst-grad} % For gradients
% \usepackage{pst-plot} % For axes
\scalebox{0.95} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-2.12)(12.480156,2.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0471875,0.3)(1.0471874,0.3)
\pscircle[linewidth=0.04,dimen=outer](1.2471875,0.3){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.4471874,0.3)(2.36,0.3)
\psframe[linewidth=0.04,dimen=outer](3.56,0.7)(2.36,-0.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(3.56,0.3)(4.36,0.3)
\psframe[linewidth=0.04,dimen=outer](5.56,0.7)(4.36,-0.1)
\psframe[linewidth=0.04,dimen=outer](8.36,0.7)(7.16,-0.1)
\psframe[linewidth=0.04,dimen=outer](10.96,0.7)(9.76,-0.1)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(5.447188,0.3)(7.16,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{<-}(1.2471875,0.1)(1.2471875,-2.1)
\psline[linewidth=0.04cm](1.2471875,-2.1)(11.56,-2.1)
\usefont{T1}{ppl}{m}{n}
\rput(0.45453125,0.61){$r(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(1.5807812,0.61){$\epsilon (t)$}
\usefont{T1}{ppl}{m}{n}
\rput(3.930781,0.57){$v(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(6.365625,0.61){$u(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(9.460782,0.61){$z(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(11.895625,0.61){$y(t)$}
\psline[linewidth=0.04cm](1.4671875,0.08)(1.6671875,0.08)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](5.96,1.3)(1.96,-0.7)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](11.36,2.1)(6.76,-0.7)
\usefont{T1}{ppl}{m}{n}
\rput(3.950781,-0.99){$\mathcal{C}$}
\usefont{T1}{ppl}{m}{n}
\rput(8.870782,-0.99){$\mathcal{S}_{nl}$}
\usefont{T1}{ppl}{m}{n}
\rput(2.9207811,0.31){$\gamma(\cdot)$}
\usefont{T1}{ppl}{m}{n}
\rput(10.320781,0.31){$\zeta(\cdot)$}
\usefont{T1}{ppl}{m}{n}
\rput(4.910781,0.31){$C'(q)$}
\usefont{T1}{ppl}{m}{n}
\rput(7.720781,0.31){$G_0(q)$}
\psframe[linewidth=0.04,dimen=outer](8.36,1.7)(7.16,0.9)
\usefont{T1}{ppl}{m}{n}
\rput(7.720781,1.29){$H_0(q)$}
\psline[linewidth=0.04cm](8.36,1.3)(8.96,1.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(8.96,1.3)(8.96,0.5)
\pscircle[linewidth=0.04,dimen=outer](8.96,0.3){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(8.36,0.3)(8.76,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(9.16,0.3)(9.76,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.36,1.3)(7.16,1.3)
\usefont{T1}{ppl}{m}{n}
\rput(6.285625,1.61){$e(t)$}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(10.96,0.3)(12.16,0.3)
\psline[linewidth=0.04cm](11.56,-2.1)(11.56,0.3)
\end{pspicture} 
}
\caption{Diagrama de blocos para um sistema não linear do tipo Wiener}
\label{fig:vrft_nl_wiener}
\end{figure}

Ao fazê-lo, o controlador ideal depende apenas do erro de referência, mas a função  $\gamma(\cdot )$ depende do valor de
referência, e será uma função diferente para cada valor diferente da referência. Além disso, para valores não
constantes, a não linearidade inversa $\gamma(\cdot)$ pode não ser autónoma, violando outra pressuposição da formulação
não linear do VRFT proposta em \cite{campi_savaresi2006}.

Agora, entretanto é desejado que o sistema se comporte linearmente em malha fechada como $T_d(q)$. Para obter-se isso o
controlador deve cancelar todos os efeitos não lineares de $\zeta(z(t))$. Em outras palavras, é desejado que em malha
fechada o sinal $v(t)$ obedeça a equação (\ref{vzlinear}). Entretanto o sistema apresentado na Figura
\ref{fig:vrft_nl_wiener} se comporta como em:

\begin{equation}
v(t)=\gamma (r(t) - y(t))
\nonumber
\end{equation}
e assim pode-se obter a relação entre $\gamma(\cdot) $ e $\zeta(\cdot)$ como:

\begin{equation}
\gamma (r(t) - \zeta(z(t))) = \alpha [r(t) - z(t)] .
\label{eq:dbnarmac_ex_wiener_psi}
\end{equation}

Fica claro que quando não existe um sinal de referência, $r(t) \equiv 0$, a relação entre os polinômios $\gamma(\cdot)$ e
$\zeta(\cdot)$ fica simplificada a:

\begin{equation}
\gamma (\zeta(z(t))) = -\alpha z(t)
\nonumber 
\end{equation}
então neste caso (mas apenas neste caso) $\gamma(\cdot )$ deve ser a inversa de  $\zeta(\cdot)$, a menos de uma
constante.

\subsection{Convexidade}

O ponto principal do paradigma de referência virtual é de deixar o problema de modelo de referência convexo. Isso é
obtido no método VRFT por meio de uma parametrização linear do controlador e o projeto do controlador é obtido por
meio da solução de um problema de mínimos quadrados.

Para aproveitar esta virtude computacional é necessário ter um controlador parametrizável linearmente. Desde
que a inversa é assumidamente analítica, ela pode ser expandida em serie de Taylor e então truncada:

$$
\zeta_R^{-1} ( x ) \cong  \sum_{i=0}^{k} \frac{1}{i!}\frac{\partial^i \zeta_R^{-1} }{\partial x^i}( 0 ) x^i 
$$%\\ & \bydef & \sum_{i=0}^{k} \alpha_i x^i \eeqan

Se o controlador e a função não linear forem ambos parametrizáveis linearmente, ou seja, 

\begin{eqnarray}
C'(q,\rho ) & = & \frac{1}{D(q)} \rho^T N(q) \label{um} \\
\gamma(\epsilon(t)) & = & \eta^T E(t) \label{dois}
\end{eqnarray}
com $D(q)$ sendo um polinômio mônico conhecido, $N(q)\bydef [1 \quad q^{-1} q^{-2} \ldots
q^{-p}]^T$, e $E(t) \bydef [\epsilon (t) \quad \epsilon^2 (t) \ldots \epsilon^k (t)]^T$.
Então, definindo  $u_f(t) = D(q) u(t)$ e substituindo as equações \eqref{um} e \eqref{dois} em
\eqref{eq:hammer_u} leva a:

\begin{equation}
u_f(t) = \sum_{i=0}^{p} \sum_{j=1}^k \theta_{i+j} \epsilon^j(t-i)
\end{equation}
ou
\begin{equation}
u_f(t) = \theta^T \varpi(t)
\end{equation}
onde $\theta_{i+j} \bydef \rho_i\eta_j$ e o vetor $\theta=\left[ \theta_1 \ldots \theta_{pk}\right]^T$ são os parâmetros a
serem identificados. Note que um preço precisa ser pago para obter-se uma parametrização linear: o número de parâmetros
que inicialmente era igual a $p+k$, agora é $p\times k$.

O exemplo numérico abaixo visa demonstrar este método proposto para o projeto de controladores do tipo Hammerstein.

%===============================================================================
\subsection{Exemplo numérico}
\label{sec:dbnarmax_wiener_hammerstein_exemple}
%===============================================================================
 
Considere uma planta não linear $\mathcal{S}_{nl}$ do tipo Wiener como apresentado na Figura \ref{fig:vrft_nl_wiener}.
Considere ainda que o bloco linear e não linear desta planta pode ser descrito como:

\begin{equation}
G'(q)=\frac{0.5}{q-0.9}
\label{eq:vrft_nl_wiener_g}
\end{equation}
e

\begin{equation}
\zeta(z(t))=y(t)=1.5z(t)+0.2z^3(t)
\label{eq:vrft_nl_wiener_zeta}
\end{equation}  

Deseja-se que esta planta seja controlada para que o comportamento em malha fechada possa ser descrito como em:

\begin{equation}
T_d(q)=\frac{0.4}{q-0.6}
\label{eq:vrft_nl_wiener_td}
\end{equation}

O controlador é definido pela forma apresentada em \eqref{eq:track_error_controller_u} e
\eqref{eq:track_error_controller_v} com $C(q, \theta)$ como um controlador do tipo proporcional integral (PI).

\begin{equation}
C(q, \theta)=\theta_1\frac{1}{q-1}+\theta_2\frac{q}{q-1}
\label{eq:dbnarmax_ex_wiener_controller_class_pi}
\end{equation}  
e a função não linear sendo representada por um polinômio de quarta ordem como:

\begin{equation}
\gamma (\epsilon(t))= v(t) = a_1\epsilon (t) + a_2 \epsilon ^2(t) +a_3 \epsilon ^3(t) +a_4 \epsilon ^4(t)
\label{eq:dbnarmax_ex_wiener_gamma_choosen}
\end{equation}  

Considerando entretanto que nenhum dos blocos não lineares existissem no sistema, o controlador ideal poderia ser descrito pela equação
\eqref{eq:dbcd_perf_tracking_cd}, resultando em 

\begin{equation}
C_d'(q)= \frac{0.8q-0.72}{q-1}
\label{eq:vrft_nl_wiener_cd}
\end{equation}
o qual pode ser exatamente descrito pela classe de controladores apresentada em
\eqref{eq:dbnarmax_ex_wiener_controller_class_pi}.

A parte não linear do controlador ideal é a inversa da função não linear $\zeta(\cdot )$ dada em
\eqref{eq:vrft_nl_wiener_zeta}. Esta função será aproximada por uma série de Taylor truncada como em
\eqref{eq:dbnarmax_ex_wiener_gamma_choosen}, o que significa, rigorosamente falando, que $C_d(q)$ não pode ser
	representado por $C(q, \theta)$, ou seja, $C_d(q) \notin C(q, \theta)$. Se pro ventura o desempenho do controlador
encontrado não for satisfatório, pode-se aumentar a ordem da série de Taylor utilizada para a aproximação, o que pode
ser arbitrariamente feito até obter-se um desempenho próximo ao desejado.

O controlador $C_d'(q)$ possui um integrador em sua estrutura. Para evitar problemas de seguimento de
referência optou-se por não identificar esta parte do controlador, mantendo o denominador como um integrador
e identificando apenas o numerador. 

Fazendo-se as substituições necessárias, chega-se à expressão do sinal de saída do controlador:

\begin{align}\nonumber
u_f(t) =&  \theta_1 \epsilon (t)+ \theta_2 \epsilon ^2(t)+ \theta_3 \epsilon^3(t)+ \theta_4 \epsilon^4(t)+\\
& \theta_5 \epsilon(t-1)+ \theta_6 \epsilon^2(t-1)+  \theta_7 \epsilon^3(t-1)+ \theta_8 \epsilon^4(t-1)
\label{eq:dbnarmax_ex_wiener_controller}
\end{align}
onde $u_f(t)$ denota que $u(t)$ foi filtrado pelo denominador de $C_d'(q)$ em \eqref{eq:vrft_nl_wiener_cd}.

Foram realizados 100 experimentos de Monte Carlo adicionando um ruído com $\sigma_e^2=0.05$ e utilizando o algoritmo
proposto em conjunto com o procedimento de referência virtual para obter os sinais $r(t)$ e $\epsilon(t)$ e a média das
estimativas obtidas foi de:

\begin{equation}
\theta_{\text{média}} =\begin{bmatrix}
0.44717 \\ 2.0216\times10^{-3} \\ -6.5181\times10^{-4} \\ -1.608\times10^{-5} \\ -0.40435 \\ -1.6163\times10^{-3} \\
6.1265\times10^{-4}\\ 1.469\times10^{-5} 
\end{bmatrix}^T
\nonumber
\end{equation}
%com uma matriz de covariância de:
%
%\begin{equation}
%\theta_{\text{Covariância}} =\begin{bmatrix}
%5.2065e-06 & 	 -9.7986e-08 & 	 -1.9078e-08 & 	 -3.2055e-10 & 	 -3.6186e-06 & 	 1.2798e-07 & 	 5.9285e-09 & 	 -2.0474e-10  \\ 
%-9.7986e-08 & 	 5.5494e-08 & 	 -5.4726e-10 & 	 -1.5158e-10 & 	 1.0123e-07 & 	 -4.4708e-08 & 	 3.9962e-10 & 	 1.2237e-10  \\ 
%-1.9078e-08 & 	 -5.4726e-10 & 	 2.1459e-10 & 	 9.3647e-12 & 	 4.4485e-09 & 	 3.1849e-10 & 	 -2.5329e-11 & 	 -2.0593e-12  \\ 
%-3.2055e-10 & 	 -1.5158e-10 & 	 9.3647e-12 & 	 8.0071e-13 & 	 -1.9028e-10 & 	 8.5314e-11 & 	 -1.6175e-12 & 	 -2.9308e-13  \\ 
%-3.6186e-06 & 	 1.0123e-07 & 	 4.4485e-09 & 	 -1.9028e-10 & 	 5.0042e-06 & 	 -8.9899e-08 & 	 -1.6759e-08 & 	 -1.5359e-10  \\ 
%1.2798e-07 & 	 -4.4708e-08 & 	 3.1849e-10 & 	 8.5314e-11 & 	 -8.9899e-08 & 	 6.9081e-08 & 	 -7.8269e-10 & 	 -2.0938e-10  \\ 
%5.9285e-09 & 	 3.9962e-10 & 	 -2.5329e-11 & 	 -1.6175e-12 & 	 -1.6759e-08 & 	 -7.8269e-10 & 	 1.5274e-10 & 	 7.6667e-12  \\ 
%-2.0474e-10 & 	 1.2237e-10 & 	 -2.0593e-12 & 	 -2.9308e-13 & 	 -1.5359e-10 & 	 -2.0938e-10 & 	 7.6667e-12 & 	 9.0946e-13  \\ 
%\end{bmatrix}
%\nonumber
%\end{equation}

O custo obtido  foi $J_{y}(\theta_{\text{média}})=3.0078\times10^{-3}$; isso significa que, a cada amostra, esta é a
média da diferença entre o sinal de saída obtido e o desejado. Para as estimativas foram utilizados sinais de entrada do
tipo PRBS com 127 pontos para a excitação da planta.  Na Figura \ref{fig:vrft_nl_wiener_step} é apresentado um
comparativo entre o sinal de saída do sistema $T_d(q)$ quando submetido a um degrau unitário e o sinal do sistema real
quando o controlador identificado com $\theta_{\text{médio}}$ é aplicado sobre a planta em malha fechada.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_step.eps}
	\caption{Comparativo da resposta a um degrau unitário do modelo de referência $T_d(q)$ com o sistema real quando o
	controlador não linear é inserido na planta.}
	\label{fig:vrft_nl_wiener_step}
\end{figure}

Na Figura \ref{fig:vrft_nl_wiener_vw_step} é apresentado o comportamento dos sinais de saída e entrada das
não linearidades $\gamma(\epsilon(t))$ e $\zeta(z(t))$ respectivamente.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_vw_step.eps}
	\caption{Sinais $v(t)$ e $z(t)$ do sistema apresentado na Figura \ref{fig:vrft_nl_wiener} quando este é
	excitado por um degrau unitário.}
	\label{fig:vrft_nl_wiener_vw_step}
\end{figure}

A relação entre os sinais $v(t)$ e $z(t)$ é apresentado na Figura \ref{fig:vrft_nl_wiener_vw}.
Observa-se que a relação destes sinais é afim, garantido desta forma que a aproximação feita em
\eqref{eq:dbnarmax_ex_wiener_gamma_choosen} foi suficiente para representar com acuracidade o que era esperado para
$\gamma(t)$ em \eqref{eq:dbnarmac_ex_wiener_psi}.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_vw.eps}
	\caption{Relação entre os sinais $v(t)$ e $z(t)$ quando o sistema é alimentado por um degrau unitário}
	\label{fig:vrft_nl_wiener_vw}
\end{figure}

