% ===============================================================================
\section{Exemplos ilustrativos}
\label{sec:dbnarmax_nonlinear_examples}
%===============================================================================

Neste trabalho o foco está em apresentar os resultados da identificação de sistemas que podem ser descritos por modelos
NARMAX racionais ou polinomiais. Sendo que para isso serão apresentados exemplos de identificação de sistemas onde a
linearidade é estática assim como quando a não linearidade está na dinâmica do sistema.

Nos exemplos abordados a seguir as não linearidades estarão presentes na planta do sistema e deseja-se que este sistema
se comporte em malha fechada como um sistema linear. Para isso o controlador adicionado na malha deverá ser capaz de
anular a não linearidade contida na planta, desta forma, forçozamente o controlador será não linear, sendo descrito por
um modelo NARMAX racional ou polinomial.

Os exemplos apresentados a seguir são divididos em duas categorias: uma delas onde a não linearidade da planta está
acoplada de forma estática e outra quando a não linearidade está na dinâmica do processo.

%===============================================================================
\subsection{Não linearidades estáticas}
\label{sec:dbnarmax_nl_wiener}
%===============================================================================

A planta do sistema utilizada neste exemplo possui uma não linearidade estática do tipo Wiener, onde o bloco não linear
encontra-se na saída do processo. Na Figura \ref{fig:vrft_nl_wiener} é apresentado o diagrama de blocos do sistema,
sendo $\zeta(t)$ e $\gamma(t)$ os blocos não lineares da planta e do controlador respectivamente. Análogamente
$G'(z)$ e $C'(z)$ são os blocos lineares da planta e do controlador. Como a não linearidade do controlador está na
entrda deste, pode ser caracterizado como uma classe de Hammerstein, mas será identificado por uma classe de modelos
NARMAX racional.

\begin{figure}[htbp]
\center
% Generated with LaTeXDraw 2.0.8
% Sat Jun 16 14:47:44 BRT 2012
% \usepackage[usenames,dvipsnames]{pstricks}
% \usepackage{epsfig}
% \usepackage{pst-grad} % For gradients
% \usepackage{pst-plot} % For axes
\scalebox{1} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-1.72)(13.22,1.7)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(0.0,0.7)(1.0,0.7)
\pscircle[linewidth=0.04,dimen=outer](1.2,0.7){0.2}
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(1.4,0.7)(2.8,0.7)
\psframe[linewidth=0.04,dimen=outer](4.0,1.1)(2.8,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(4.0,0.7)(5.0,0.7)
\psframe[linewidth=0.04,dimen=outer](6.2,1.1)(5.0,0.3)
\psframe[linewidth=0.04,dimen=outer](9.2,1.1)(8.0,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(9.2,0.7)(10.2,0.7)
\psframe[linewidth=0.04,dimen=outer](11.4,1.1)(10.2,0.3)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(6.2,0.7)(8.0,0.7)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{->}(11.4,0.7)(13.2,0.7)
\psline[linewidth=0.04cm,arrowsize=0.05291667cm 2.0,arrowlength=1.4,arrowinset=0.4]{<-}(1.2,0.5)(1.2,-1.7)
\psline[linewidth=0.04cm](1.2,-1.7)(12.4,-1.7)
\psline[linewidth=0.04cm](12.4,-1.7)(12.4,0.7)
\usefont{T1}{ppl}{m}{n}
\rput(0.45828125,1.01){$r(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(1.9445312,1.01){$\epsilon (t)$}
\usefont{T1}{ppl}{m}{n}
\rput(4.514531,1.01){$v(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(7.089375,1.01){$u(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(9.664532,1.01){$\omega(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(12.499375,1.01){$y(t)$}
\psline[linewidth=0.04cm](1.6,0.5)(1.8,0.5)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](6.6,1.7)(2.4,-0.3)
\psframe[linewidth=0.04,linestyle=dashed,dash=0.16cm 0.16cm,dimen=outer](11.8,1.7)(7.6,-0.3)
\usefont{T1}{ppl}{m}{n}
\rput(4.3345313,-0.59){C(z)}
\usefont{T1}{ppl}{m}{n}
\rput(9.744532,-0.59){G(z)}
\usefont{T1}{ppl}{m}{n}
\rput(3.3945312,0.69){$\gamma(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(10.794531,0.71){$\zeta(t)$}
\usefont{T1}{ppl}{m}{n}
\rput(5.594531,0.71){C'(z)}
\usefont{T1}{ppl}{m}{n}
\rput(8.604531,0.71){G'(z)}
\end{pspicture} 
}

\caption{Diagrama de blocos para um sistema não linear do tipo Wiener}
\label{fig:vrft_nl_wiener}
\end{figure}

O sistema possui um boloco linear que pode ser descrito por:

\begin{equation}
G'(z)=\frac{0.5}{z-0.9}
\label{eq:vrft_nl_wiener_g}
\end{equation} 

O comportamento do sistema em malha fechada esperado é definido por $M(z)$:

\begin{equation}
M(z)=\frac{0.4}{z-0.6}
\label{eq:vrft_nl_wiener_m}
\end{equation}  

A não linearidade presente na planta do sistema foi escolhida como sendo um polinômio de terceira ordem
descrito como abaixo:

\begin{equation}
\zeta(\omega(t))=y(t)=1.5\omega(t)+0.2\omega^3(t)
\label{eq:vrft_nl_wiener_phi}
\end{equation}  

Espera-se então que por $M(z)$ ser linear, que o controlador tenha um bloco que cancele o efeito não linear de
$\zeta(t)$.

Deseja-se que em malha fechada o sinal $v(t)$ seja tal que:

\begin{equation}
v(t)=r(t)-\omega(t)
\end{equation}

Tem-se entretanto:

\begin{equation}
v(t)=\epsilon(t)\gamma (t)
\nonumber
\end{equation}

e que

\begin{equation}
\epsilon(t) = r(t) - y(t)
\nonumber
\end{equation}
 
Obtem-se então o relacionamento entre os sinais $\gamma (t) $ e $\zeta(t)$:

\begin{equation}
( r(t) - \omega(t) \zeta(t)) \gamma (t) = r(t) - \omega(t) 
\nonumber
\end{equation}

Resultando:

\begin{equation}
\gamma (t) = \frac{r(t)-\omega(t)}{r(t) - \omega(t)\zeta(t)} 
\end{equation}

Pecebe-se claramente que quando não há sinal de referência $r(t)$, o relacionamento entre os polinomios $\gamma (t) $
e $\zeta(t)$ fica simplificado a:

\begin{equation}
\gamma (t) = \frac{1}{\zeta(t)}
\nonumber 
\end{equation}

Define-se então $\gamma (t)$ como sendo:

\begin{equation}
\gamma (\epsilon(t))= v(t) = a_1\epsilon (t) + a_2 \epsilon ^2(t) +a_3 \epsilon ^3(t) +a_4 \epsilon ^4(t)
\label{eq:vrft_nl_wiener_phi_inv}
\end{equation}  

Desconsiderando a parte não linear presente na planta, é simples de observar que o controlador ótimo que
levaria a planta em malha fechada a ter o comportamento descrito por $M(z)$ é:

\begin{equation}
C_d(z)= \frac{0.8z-0.72}{z-1}
\label{eq:vrft_nl_wiener_cd}
\end{equation}  

O controlador $C_d(z)$ possui uma integrador em sua estrutura. Para evitar problemas de seguimento de
referência optou-se por não identificar esta parte do controlador. Mantendo o denominador como um integrador
e identificando apenas o numerador. Juntamente com a identificação do controlador da porção linear $C_d(z)$ é
necessário identificar o polinômio da equação \eqref{eq:vrft_nl_wiener_phi_inv}.

Fazendo-se as substituições matemáticas necessárias, chega-se a expressão do sinal de saída do controlador que
se quer identificar:

\begin{equation}
u(t)=\begin{bmatrix}
\theta_1 & \theta_2 & \theta_3 & \theta_4 & \theta_5 & \theta_6 & \theta_7 & \theta_8
\end{bmatrix}
\begin{bmatrix}
\epsilon (t)\\ 
\epsilon ^2(t)\\ 
\epsilon^3(t)\\ 
\epsilon^4(t)\\ 
\epsilon(t-1)\\ 
\epsilon^2(t-1)\\ 
\epsilon^3(t-1)\\ 
\epsilon^4(t-1)
\end{bmatrix}
\label{eq:vrft_nl_wiener_u}
\end{equation}  

Onserva-se que $u(t)$ em \eqref{eq:vrft_nl_wiener_u} é um modelo NARMAX polinomial. Foram realizados 100 experimentos
de Monte Carlo utilizando o algoritmo para identificação de modelos NARMAX em conjunto com o procedimento de referência
virtual para gerar os sinais $r(t)$ e $\epsilon(t)$ e a média das estimativas obtidas foi de:

\begin{equation}
\text{média }\;\theta =\begin{bmatrix}
0.4471 \\ 0.0020 \\ -6.5105\times10^{-4} \\ -1.5959\times10^{-5} \\ -0.4043 \\ -0.0016 \\ 6.1194\times10^{-4}
\\ 1.4562\times10^{-5}
\end{bmatrix}^T
\nonumber
\end{equation}

Com um desvio padrão de:

\begin{equation}
\text{média }\;\theta = 1\times10^{-3}\begin{bmatrix}
0.2430 \\ 0.0246 \\ 0.0015 \\ 0.0001 \\ 0.2613 \\ 0.0259 \\ 0.0016 \\ 0.0001
\end{bmatrix}^T
\nonumber
\end{equation}

O custo entre os sinais de saída do sistema obtido e o sistema esperado $M(z)$ foi de  $J_{MR}(\theta)=
0.3820$ e o custo dos sinais de saída do controlador ($u(t)$) esperado e obtido foi de $J_{VR}=1.0119$.

Como a estimativa de $\gamma (\epsilon(t))$ é apenas uma aproximação do que espera-se ser a inversa de
$\zeta(\omega(t))$, a classe de modelos escolhida para o controlador não consegue representar a totalidade do
controlador ideal. Desta forma é esperado que a identificação não consiga atingir a totalidade da função
$M(z)$ inicialmente escolhida. Para as estimativas foram utilizados sinais de entrada do tipo PRBS com 127 pontos para a
excitação da planta.

Na Figura (\ref{fig:vrft_nl_wiener_step}) é apresentado um comparativo entre o sinal de saída do sistema
$M(z)$ quando submetido a um degrau unitário e o sinal do sistema real quando o controlador identificado é
aplicado sobre a planta em malha fechada.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_step.eps}
	\caption{resposta dos sistemas: desejado e obtido a um degrau unitário}
	\label{fig:vrft_nl_wiener_step}
\end{figure}

Na Figura (\ref{fig:vrft_nl_wiener_vw_step}) é apresentado o comportamento dos sinais de saída e entrada das
não linearidades $\gamma(\epsilon(t))$ e $\zeta(\omega(t))$ respectivamente.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_vw_step.eps}
	\caption{sinais $v(t)$ e $\omega(t)$ quando o sistema é alimentado por um degrau unitário}
	\label{fig:vrft_nl_wiener_vw_step}
\end{figure}

A relação entre os sinais $v(t)$ e $\omega(t)$ é apresentado na Figura (\ref{fig:vrft_nl_wiener_vw}).
Observa-se que a relação destes sinais é praticamente linear, garantido que a aproximação de $\gamma(\epsilon(t))$
foi satisfatória para representar a inversa do sinal $\zeta(\omega(t))$.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_wiener_vw.eps}
	\caption{relação entre os sinais $v(t)$ e $\omega(t)$ quando o sistema é alimentado por um degrau unitário}
	\label{fig:vrft_nl_wiener_vw}
\end{figure}

%===============================================================================
\subsection{Não linearidades dinâmicas}
\label{sec:dbnarmax_nl_dinamic}
%===============================================================================

Quando a não linearidade está na dinâmica do processo não há uma distinção entre um bloco linear e outro linear como
apresentado no exeplo anterior (seção \ref{sec:dbnarmax_nl_wiener}). Serão apresentados aqui alguns exemplos de
identificação de controladores que podem ser representados por modelos NARMAX racionais.

Inicialmente um exemplo onde o controlador que leva a planta $G_0(z)$ a se comportar em malha fechada como em $M(z)$,
será totalmente representado pelo modelo escolhido para o controlador. Em seguida será apresentado para esta mesma
situação onde o controlador necessário é um pouco mais complexo, tendo mais variáveis para identificar.

Ao fim será apresentado um exemplo onde o controlador ideal não consegue ser representado pela classe de modelos
escolhida.

Em todos os exemplos será utilizado para excitar o sistema, um sinal PRBS de ordem 7.

%===============================================================================
\subsubsection{Controlador ideal sendo representado pela classe de modelos}
\label{sec:dbnarmax_nl_dinamic_c_match}
%===============================================================================

Neste exemplo será abordado o caso onde o controlador $C(z, \theta) \in \mathcal{C}$. Fazendo com que o sistema em
malha fechada se comporte como desejado. Considere a planta não linear descrita por:

\begin{equation}
y(t)=\frac{0.5u(t-1)y(t-1)+u(t-1)}{1+0.25y^2(t-2)}
\label{eq:vrft_nl_dinamic_ex1_y}
\end{equation}

Deseja-se que em malha fechada seu comportamento seja linear como em:

\begin{equation}
M(z)=\frac{0.4}{z-0.6}
\label{eq:vrft_nl_dinamic_ex1_mz}
\end{equation}

A equação \eqref{eq:vrft_nl_dinamic_ex1_mz} pode ser reescrita em função do tempo como em:

\begin{equation}
y(t)=0.4r(t-1)+0.6y(t-1)
\label{eq:vrft_nl_dinamic_ex1_mt}
\end{equation}

Ao igualar a equação \eqref{eq:vrft_nl_dinamic_ex1_y} com \eqref{eq:vrft_nl_dinamic_ex1_mt} e isolar o
sinal $u(t)$ tem-se a equação que descreve o comportamento do controlador que levará a planta a ter o
comportamento descrito por $M(z)$ em malha fechada. Obtém-se desta forma um controlador ideal como em:

\begin{equation}
u(t)=\frac{0.4r(t)+0.6y(t)+0.1y^2(t-1)r(t)+0.15y(t)y^2(t-1)}{1+0.5y(t)}
\label{eq:vrft_nl_dinamic_ex1_cd}
\end{equation}

Escolhendo uma classe de modelos que consegue representar o controlador ótimo:

\begin{equation}
u(t)=\frac{\theta_1 r(t)+ \theta_2 y(t)+ \theta_3 y^2(t-1)r(t)+ \theta_4 y(t)y^2(t-1)}{1+ \theta_5 y(t)}
\label{eq:vrft_nl_dinamic_ex1_c}
\end{equation}

Utilizando um sinal PRBS de tamanho 254 pontos e o método de referência virtual para gerar os sinais $r(t)$ e
$\epsilon(t)$. Adicionando-se um ruido de variância $\sigma^2 = 0.005$ a saída do sistema, a média das estimativas para
100 experimentos de Monte Carlo foi de:

\begin{equation}
\theta_{\text{média}}=\begin{bmatrix}
0.4000 & 0.5999 & 0.1001 & 0.1501 & 0.5000
\end{bmatrix}
\nonumber
\end{equation}

Os valores reais utilizados na simulação foram:

\begin{equation}
\theta^{*}=\begin{bmatrix}
0.4 & 0.6 & 0.1 & 0.15 & 0.5
\end{bmatrix}
\nonumber
\end{equation} 

Obte-se um desvio padrão para as estimativas de:

\begin{equation}
\theta_{\text{desvio padrão}}=1.0\times 10^{-3}\begin{bmatrix}
0.2231 & 0.6866 & 0.2411 & 0.6817 & 0.3019
\end{bmatrix}
\nonumber
\end{equation}

A matriz de covariância é descrita por:

\begin{equation}
\theta_{\text{Covariância}}=1.0\times 10^{-6}\begin{bmatrix}
 0.0498 &  0.0585 & -0.0353 & -0.0362 & -0.0018 \\
 0.0585 &  0.4714 & -0.0449 & -0.3690 &  0.0057 \\
-0.0353 & -0.0449 &  0.0581 &  0.0745 & -0.0040 \\
-0.0362 & -0.3690 &  0.0745 &  0.4647 & -0.0070 \\
-0.0018 &  0.0057 & -0.0040 & -0.0070 &  0.0911
\end{bmatrix}
\nonumber
\end{equation}

Simulando o sistema com o controlador obtido pela média das estimativas e o sistema em malha fechada
desejado, o erro observado para um sinal de entrada do tipo degrau unitário é apresentado na Figura
\ref{fig:vrft_nl_dynamic_step_erro}.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_dynamic_erro_step.eps}
	\caption{Erro entre o a resposta esperada e obtida para uma entrada do tipo degrau unitário}
	\label{fig:vrft_nl_dynamic_step_erro}
\end{figure}

A fim de ilustrar as estimativas obtidas pelo método, na Figura \ref{fig:vrft_nl_dynamic_t1_t2} são
apresentados as estimativas para os 100 experimentos realizados, além da elipse de confiança de $\chi^2=95\%$
para os parametros $\theta_1$ e $\theta_2$.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vrft_nl_dynamic_t1_t2.eps}
	\caption{100 esperimentos de Monte Carlo das variáveis $\theta_1$ e $\theta_2$}
	\label{fig:vrft_nl_dynamic_t1_t2}
\end{figure}

O custo $J_{VR}=2.7291\times10{-8}$ foi obtido utilizando-se os sinais de saída do controlador obtido e
esperado. Já o custo entre os sinais de saída do sistema em malha fechada estimado e desejado foi de
$J_{MR}=0.0033$.

Com o intuito de demonstrar o efeito do ruído sobre as estimativas obtidas o ruido foi aumentado em $4\times$ para
$\sigma^2 = 0.02$. Obteve-se desta forma os seguintes resultados paras as estimativas:

\begin{equation}
\theta_{\text{média}}=\begin{bmatrix}
0.3999 & 0.5996 & 0.1001 & 0.1502 & 0.4999
\end{bmatrix}
\nonumber
\end{equation}

\begin{equation}
\theta_{\text{Desvio padrão}}=\begin{bmatrix}
0.0010 & 0.0027 & 0.0012 & 0.0027 & 0.0012
\end{bmatrix}
\nonumber
\end{equation}

\begin{equation}
\theta_{\text{Covariância}}=1.0\times 10^{-5}\begin{bmatrix}
    0.1061 &  0.1207 & -0.0894 & -0.1185 & -0.0310 \\
    0.1207 &  0.7122 & -0.1048 & -0.5357 &  0.0038 \\
   -0.0894 & -0.1048 &  0.1344 &  0.1972 & -0.0033 \\
   -0.1185 & -0.5357 &  0.1972 &  0.7523 & -0.0571 \\ 
   -0.0310 &  0.0038 & -0.0033 & -0.0571 &  0.1355
\end{bmatrix}
\nonumber
\end{equation}

Com os custos de $J_{VR}=1.0326\times10{-7}$ e $J_{MR}=0.0054$, corroborando para o fato de que os custos não
foram significativamente afetados pelo aumento do ruído. Fazendo assim com que a estimativa ainda seja confiável.

%===============================================================================
\subsubsection{Controlador ideal sendo representado pela classe de modelos 2}
\label{sec:dbnarmax_nl_dinamic_c_match2}
%===============================================================================

%===============================================================================
\subsubsection{Controlador não sendo representado pelo modelo}
\label{sec:dbnarmax_nl_dinamic_c_not_match}
%===============================================================================

Neste exemplo será abordado o caso onde o controlador $C(z, \theta) \notin \mathcal{C}$. Fazendo com que o sistema em
malha fechada não consiga ter a dinâmica esperada. Considere a planta não linear descrita por:

\begin{equation}
y(t)=\frac{0.5u(t-1)y(t-1)+u(t-1)}{1+0.25y^2(t-2)}
\label{eq:vrft_nl_dinamic_ex3_y}
\end{equation}

Deseja-se que em malha fechada seu comportamento seja linear como em:

\begin{equation}
M(z)=\frac{0.4}{z-0.6}
\label{eq:vrft_nl_dinamic_ex3_mz}
\end{equation}

A equação \eqref{eq:vrft_nl_dinamic_ex3_mz} pode ser reescrita em função do tempo como em:

\begin{equation}
y(t)=0.4r(t-1)+0.6y(t-1)
\label{eq:vrft_nl_dinamic_ex3_mt}
\end{equation}

Ao igualar a equação \eqref{eq:vrft_nl_dinamic_ex3_y} com \eqref{eq:vrft_nl_dinamic_ex3_mt} e isolar o
sinal $u(t)$ tem-se a equação que descreve o comportamento do controlador que levará a planta a ter o
comportamento descrito por $M(z)$ em malha fechada. Obtém-se desta forma um controlador ideal como em:

\begin{equation}
u(t)=\frac{0.4r(t)+0.6y(t)+0.1y^2(t-1)r(t)+0.15y(t)y^2(t-1)}{1+0.5y(t)}
\label{eq:vrft_nl_dinamic_ex3_cd}
\end{equation}

No exemplo apresentado na seção \ref{sec:dbnarmax_nl_dinamic_c_match} foi apresentada a simulação para quando o controlador
ótimo consegue ser descrito pelo modelo escolhido para representa-lo. Neste exeplo deseja-se o oposto: que a classe de
modelos escolhida para o controlador não consiga representar completamente \eqref{eq:vrft_nl_dinamic_ex3_cd}. Para isso
escolheu-se a seguinte classe de modelos para representar o controlador:

\begin{equation}
u(t)=\frac{\theta_1 r(t)+ \theta_2 y(t)+ \theta_3 r(t)y(t-1)+ \theta_4 y(t-1)y(t)}{1+ \theta_5 y(t)}
\label{eq:vrft_nl_dinamic_ex3_c}
\end{equation}

Para as simulações foi adicionado um ruído com $\sigma^2 = 0.05$. Foram realizados 100 experimentos de Monte Carlo onde
obteve-se as seguintes estimativas:

\begin{equation}
\theta_{\text{média}}=\begin{bmatrix}
0.4696 & 0.7011 & 0.0083 & 0.0063 & 0.5013
\end{bmatrix}
\label{eq:vr_rational_ex3_theta}
\end{equation}

\begin{equation}
\theta_{\text{Desvio padrão}}=\begin{bmatrix}
0.0017 & 0.0058 & 0.0020 & 0.0064 & 0.0025
\end{bmatrix}
\nonumber
\end{equation}

\begin{equation}
\theta_{\text{Covariância}}=1.0\times 10^{-4}\begin{bmatrix}
    0.0278 &  0.0396 &  0.0035 &  0.0146 & -0.0137 \\
    0.0396 &  0.3328 &  0.0066 & -0.1651 &  0.0063 \\
    0.0035 &  0.0066 &  0.0382 &  0.0688 & -0.0119 \\
    0.0146 & -0.1651 &  0.0688 &  0.4130 & -0.0562 \\
   -0.0137 &  0.0063 & -0.0119 & -0.0562 &  0.0646
\end{bmatrix}
\nonumber
\end{equation}

Obte-se um custo para o comportamento do sistema em malha fechada de  $J_{MR}=1.0999$. Na Figura
\ref{fig:vr_rational_notinclass_ex3_error} é apresentado o erro para o sistema desejado e o sistema obtido utilizando-se
o modelo obtido com os valores de $\theta$ apresentados em \eqref{eq:vr_rational_ex3_theta} para uma referência do tipo
degrau unitário.

\begin{figure}[htbp] 
	\center 
	\includegraphics[width=0.95\columnwidth]{figures/vr_rational_notinclass_ex3_error.eps}
	\caption{Erro entre o comportamento do sistema em malha fechada e o comportamento em malha fechada desejado.}
	\label{fig:vr_rational_notinclass_ex3_error}
\end{figure}






















